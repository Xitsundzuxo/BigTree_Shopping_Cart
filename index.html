<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BigTree Shopping Cart</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Space Grotesk', sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .slide-in {
      animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    .fade-in {
      animation: fadeIn 0.2s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .cart-badge {
      animation: pop 0.3s ease-out;
    }
    @keyframes pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    /* Preloader Styles */
    #preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }
    .preloader-content {
      text-align: center;
      animation: fadeIn 0.5s ease-out;
    }
    .app-name {
      font-size: 2.5rem;
      font-weight: 700;
      background: linear-gradient(45deg, #00ff88, #00ccff);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 30px;
      text-shadow: 0 2px 10px rgba(0, 255, 136, 0.3);
      animation: fadeIn 0.9s ease-out 0.9s both;
    }
    .preloader-logo {
      width: 120px;
      height: 120px;
      margin-bottom: 30px;
      animation: fadeIn 0.9s ease-out 0.9s both;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
    }
    
    /* Fixed Menu Panel Styles */
    #menuPanel {
      position: fixed;
      top: 70px;
      right: 16px;
      width: 256px;
      z-index: 1000;
      max-height: calc(100vh - 80px);
      overflow-y: auto;
    }
    
    /* Add a backdrop for better visibility */
    .menu-backdrop {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: transparent;
      z-index: 999;
      display: none;
    }
    
    /* Weather card styles */
    .weather-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }
    .weather-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }
    .temp-gradient {
      background: linear-gradient(45deg, #4facfe 0%, #00f2fe 100%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .humidity-gradient {
      background: linear-gradient(45deg, #a6c0fe 0%, #f68084 100%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .wind-gradient {
      background: linear-gradient(45deg, #43e97b 0%, #38f9d7 100%);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    
    /* Add these to your existing styles */
.chat-message {
  animation: fadeIn 0.3s ease-out;
}

.chat-message.bot {
  border-left: 4px solid #3b82f6;
}

.chat-message.user {
  border-left: 4px solid #10b981;
  margin-left: 20px;
}

/* Speech bubble for robot */
.robot-tooltip::after {
  content: '';
  position: absolute;
  top: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: #374151 transparent transparent transparent;
}

/* Robot animation */
@keyframes robotBounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.robot-container:hover img {
  animation: robotBounce 0.5s ease-in-out;
}

/* Typing animation */
@keyframes typing {
  0% { opacity: 0.3; }
  50% { opacity: 1; }
  100% { opacity: 0.3; }
}

/* Floating Robot Animation */
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

#fixed-robot img {
  animation: float 4s ease-in-out infinite;
  box-shadow: 0 10px 25px rgba(59, 130, 246, 0.5);
}

#fixed-robot:hover img {
  animation: float 2s ease-in-out infinite;
  filter: brightness(1.1);
}

/* Pulse animation for status dot */
@keyframes pulse-glow {
  0%, 100% { 
    box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
  }
  50% { 
    box-shadow: 0 0 0 8px rgba(34, 197, 94, 0);
  }
}

#robot-status {
  animation: pulse-glow 2s infinite;
}

/* Make sure robot is above everything */
#fixed-robot {
  z-index: 100;
}

/* Remove any conflicting styles from the previous robot implementation */
.robot-tooltip::after {
  display: none;
}

</style>
</head>

 <body class="bg-gradient-to-br from-gray-900 to-black min-h-screen text-white">
  
  <!-- Preloader with App Name and Logo -->
  <div id="preloader">
    <div class="preloader-content">
      <div class="app-name">BigTree Shopping Cart</div>
      <img src="BigTree_logo.png" class="preloader-logo" alt="BigTree Logo">
      
    </div>
  </div>

  <!-- Fixed Header with Logo and Menu -->
  <header class="flex items-center justify-between px-6 py-4 sticky top-0 bg-gray-900/90 backdrop-blur-md z-50 border-b border-gray-800">
    <div class="flex items-center space-x-3">
      <div class="flex items-center space-x-2">
        <img src="BigTree_logo.png" class="w-8 h-8" alt="App Logo">
      </div>
      <div>
        <span class="font-bold text-xl">BigTree Shopping Cart</span>
        <div class="text-xs text-gray-400">Home</div>
      </div>
    </div>
    <button onclick="toggleMenu()" class="text-2xl hover:text-green-400 transition-colors p-2">‚ò∞</button>
  </header>

  

  <!-- Menu Backdrop (for closing menu when clicking outside) -->
  <div id="menuBackdrop" class="menu-backdrop" onclick="closeMenu()"></div>

  <!-- Menu Panel - Now Fixed Position -->
  <div id="menuPanel" class="hidden">
    <div class="bg-gray-800/95 backdrop-blur-md rounded-xl p-4 space-y-2 border border-gray-700 shadow-2xl">
      <a href="index.html" class="flex items-center p-3 rounded-lg bg-green-900/30 text-green-300 border border-green-800/30">
        <i class="fas fa-home w-6 mr-3"></i>
        <span class="font-medium">Home</span>
      </a>
      <a href="grocery.html" class="flex items-center p-3 rounded-lg hover:bg-gray-700/50 transition">
        <i class="fas fa-shopping-cart w-6 mr-3 text-gray-400"></i>
        <span>Grocery List</span>
      </a>
      <a href="weather.html" class="flex items-center p-3 rounded-lg hover:bg-gray-700/50 transition">
        <i class="fas fa-cloud-rain w-6 mr-3 text-gray-400"></i>
        <span>Weather</span>
      </a>
      <a href="about.html" class="flex items-center p-3 rounded-lg hover:bg-gray-700/50 transition">
        <i class="fas fa-info-circle w-6 mr-3 text-gray-400"></i>
        <span>About Us</span>
      </a>
      <a href="terms.html" class="flex items-center p-3 rounded-lg hover:bg-gray-700/50 transition">
        <i class="fas fa-file-contract w-6 mr-3 text-gray-400"></i>
        <span>Terms & Conditions</span>
      </a>
      <a href="tutor.html" class="flex items-center p-3 rounded-lg hover:bg-gray-700/50 transition">
        <i class="fas fa-graduation-cap w-6 mr-3 text-gray-400"></i>
        <span>Tutorials</span>
      </a>
    </div>
  </div>

  <!-- The rest of your HTML remains exactly the same -->
  <div id="app" class="min-h-screen w-full overflow-auto hidden" style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);">
    <!-- Main Shopping View -->
    <div id="main-view" class="min-h-screen p-4 md:p-6">
      <!-- Page Header (Moved under the fixed header) -->
      <div class="mb-6 pt-2">
        <div class="flex gap-2 justify-end">
          <button id="history-btn" onclick="showHistory()" class="relative px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-xl font-medium transition-all flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg> History
          </button>
          <button id="cart-btn" onclick="showCart()" class="relative px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl font-medium transition-all flex items-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg> Cart
            <span id="cart-badge" class="absolute -top-2 -right-2 bg-red-500 text-white text-xs w-6 h-6 rounded-full flex items-center justify-center font-bold hidden">0</span>
          </button>
        </div>
      </div>
      
      <!-- Quick Actions -->
      <div class="flex gap-2 mb-4">
        <button onclick="showImportModal()" class="flex-1 py-3 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/50 text-blue-300 rounded-xl font-medium transition-all flex items-center justify-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg> Import List
        </button>
        <button onclick="showPresetsModal()" class="flex-1 py-3 bg-purple-500/20 hover:bg-purple-500/30 border border-purple-500/50 text-purple-300 rounded-xl font-medium transition-all flex items-center justify-center gap-2">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
          </svg> Quick Add
        </button>
      </div>
      
      <!-- Add Item Form -->
      <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-5 mb-6 border border-white/20">
        <h2 class="text-lg font-semibold text-white mb-4">Add Item to Cart</h2>
        <form id="add-item-form" onsubmit="addToCart(event)" class="space-y-4">
          <div>
            <label for="item-name" class="block text-sm text-gray-300 mb-1">Item Name</label>
            <div class="relative">
              <input type="text" id="item-name" required placeholder="Enter item name or use voice" class="w-full px-4 py-3 pr-12 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent">
              <button type="button" onclick="startVoiceInput('item-name')" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 text-gray-400 hover:text-white transition-colors">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                </svg>
              </button>
            </div>
          </div>
          
          <div>
            <label for="item-price" class="block text-sm text-gray-300 mb-1">Price (R)</label>
            <div class="relative">
              <input type="number" id="item-price" required min="0.01" step="0.01" placeholder="0.00" class="w-full px-4 py-3 pr-12 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent">
              <button type="button" onclick="startVoiceInput('item-price')" class="absolute right-2 top-1/2 -translate-y-1/2 p-2 text-gray-400 hover:text-white transition-colors">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
                </svg>
              </button>
            </div>
          </div>
          
          <div>
            <label for="item-quantity" class="block text-sm text-gray-300 mb-1">Quantity</label>
            <div class="flex items-center gap-3">
              <button type="button" onclick="decrementQuantity()" class="w-12 h-12 bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 text-red-300 rounded-xl font-bold text-xl transition-all flex items-center justify-center">‚àí</button>
              <input type="number" id="item-quantity" value="1" min="1" readonly class="flex-1 text-center px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white text-lg font-semibold focus:outline-none focus:ring-2 focus:ring-emerald-500">
              <button type="button" onclick="incrementQuantity()" class="w-12 h-12 bg-emerald-500/20 hover:bg-emerald-500/30 border border-emerald-500/50 text-emerald-300 rounded-xl font-bold text-xl transition-all flex items-center justify-center">+</button>
            </div>
          </div>
          
          <div class="flex gap-2">
            <button type="submit" class="flex-1 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl font-semibold transition-all transform hover:scale-[1.02]">+ Add to Cart</button>
            <button type="button" onclick="saveAsPreset()" class="px-4 py-3 bg-purple-500/20 hover:bg-purple-500/30 border border-purple-500/50 text-purple-300 rounded-xl transition-all">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
              </svg>
            </button>
          </div>
        </form>
      </div>
      
      <!-- Current Cart Preview -->
      <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-5 mb-6 border border-white/20">
        <h2 class="text-lg font-semibold text-white mb-4">Current Cart</h2>
        <div id="cart-preview" class="space-y-2 max-h-64 overflow-auto">
          <p class="text-gray-400 text-center py-4">Your cart is empty</p>
        </div>
        <div id="cart-total-preview" class="hidden mt-4 pt-4 border-t border-white/20">
          <div class="flex justify-between text-white font-semibold text-lg">
            <span>Total:</span>
            <span id="preview-total">R0.00</span>
          </div>
        </div>
      </div>

      <!-- 5-Day Weather Forecast -->
      <div class="weather-card rounded-2xl p-5 mb-6 border border-white/20">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold text-white">üìÖ 5-Day Weather Forecast</h2>
          <div class="flex items-center gap-2">
            <button onclick="refreshWeatherForecast()" class="text-sm text-blue-400 hover:text-blue-300">
              <i class="fas fa-sync-alt mr-1"></i> Refresh
            </button>
            <button onclick="useMyLocationForWeather()" class="text-sm text-green-400 hover:text-green-300">
              <i class="fas fa-location-arrow mr-1"></i> My Location
            </button>
          </div>
        </div>
        
        <!-- Current Location Display -->
        <div class="mb-4">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-300 text-sm">Location: <span id="weather-location" class="font-medium">Loading...</span></p>
              <p class="text-gray-400 text-xs">Last updated: <span id="weather-updated">Just now</span></p>
            </div>
            <div class="text-right">
              <p class="text-gray-300 text-sm">Temperature Unit:</p>
              <button onclick="toggleWeatherUnits()" class="text-sm bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 px-3 py-1 rounded-lg">
                <span id="weather-unit">¬∞C</span>
              </button>
            </div>
          </div>
        </div>
        
        <!-- 5-Day Forecast Grid -->
        <div id="weather-forecast" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3">
          <!-- Forecast cards will be dynamically added here -->
          <div class="col-span-full text-center py-6">
            <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500 mb-2"></div>
            <p class="text-gray-400">Loading weather forecast...</p>
          </div>
        </div>
      </div>

      <!-- AI Assistant Modal -->
<div id="robot-modal" class="fixed inset-0 bg-black/70 backdrop-blur-md hidden z-[100] flex items-center justify-center p-4">
  <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl w-full max-w-lg max-h-[90%] overflow-auto slide-in border border-blue-500/30">
    <div class="p-5">
      <!-- Header -->
      <div class="flex items-center justify-between mb-4">
        <div class="flex items-center space-x-3">
          <div class="relative">
            <img src="Robot.png" alt="AI Assistant" class="w-12 h-12 rounded-full border-2 border-blue-500">
            <div id="robot-modal-status" class="absolute top-0 right-0 w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
          </div>
          <div>
            <h2 class="text-xl font-bold text-white">St Crijoh Assistant AI</h2>
            <p class="text-xs text-blue-300">Powered by BigTree AI</p>
          </div>
        </div>
        <button onclick="hideRobotAssistant()" class="text-gray-400 hover:text-white p-2 rounded-full hover:bg-gray-700 transition-all">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- Chat Messages -->
      <div id="chat-messages" class="space-y-4 mb-4 max-h-96 overflow-y-auto p-2 rounded-lg bg-gray-900/50">
        <!-- Initial bot message -->
        <div class="chat-message bot bg-blue-900/30 rounded-xl p-4 border border-blue-500/20">
          <div class="flex items-start space-x-2">
            <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center">
              <i class="fas fa-robot text-sm"></i>
            </div>
            <div class="flex-1">
              <p class="text-white text-sm mb-2">
                Hello! I'm your BigTree AI Assistant! ü§ñ I can help you with:
              </p>
              <div class="space-y-2">
                <div class="flex items-center text-green-300">
                  <i class="fas fa-check-circle mr-2"></i>
                  <span class="text-sm">Shopping cart questions</span>
                </div>
                <div class="flex items-center text-green-300">
                  <i class="fas fa-check-circle mr-2"></i>
                  <span class="text-sm">Weather forecast explanations</span>
                </div>
                <div class="flex items-center text-green-300">
                  <i class="fas fa-check-circle mr-2"></i>
                  <span class="text-sm">App usage guidance</span>
                </div>
                <div class="flex items-center text-green-300">
                  <i class="fas fa-check-circle mr-2"></i>
                  <span class="text-sm">Payment calculations</span>
                </div>
                <p class="text-blue-300 text-xs mt-3">
                  <i class="fas fa-lightbulb mr-1"></i>
                  What would you like help with today?
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Questions -->
      <div class="mb-4">
        <h3 class="text-sm font-medium text-gray-300 mb-2">Quick Questions:</h3>
        <div class="grid grid-cols-2 gap-2">
          <button onclick="askQuestion('How do I add items to cart?')" class="text-xs bg-blue-500/20 hover:bg-blue-500/30 text-blue-300 px-3 py-2 rounded-lg transition-all text-left">
            <i class="fas fa-cart-plus mr-1"></i> Add Items
          </button>
          <button onclick="askQuestion('How to check weather?')" class="text-xs bg-green-500/20 hover:bg-green-500/30 text-green-300 px-3 py-2 rounded-lg transition-all text-left">
            <i class="fas fa-cloud mr-1"></i> Weather Help
          </button>
          <button onclick="askQuestion('How to calculate change?')" class="text-xs bg-purple-500/20 hover:bg-purple-500/30 text-purple-300 px-3 py-2 rounded-lg transition-all text-left">
            <i class="fas fa-calculator mr-1"></i> Payment
          </button>
          <button onclick="askQuestion('How to save presets?')" class="text-xs bg-yellow-500/20 hover:yellow-500/30 text-yellow-300 px-3 py-2 rounded-lg transition-all text-left">
            <i class="fas fa-star mr-1"></i> Presets
          </button>
        </div>
      </div>

      <!-- Input Area -->
      <div class="relative">
        <div class="flex items-center space-x-2">
          <input 
            type="text" 
            id="user-question" 
            placeholder="Type your question here..." 
            class="flex-1 px-4 py-3 bg-gray-700 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
            onkeypress="handleQuestionKeyPress(event)"
          >
          <button onclick="sendQuestion()" class="px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-semibold transition-all flex items-center gap-2">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
        <div class="flex items-center justify-between mt-2 px-2">
          <button onclick="toggleSpeechRecognition()" id="voice-btn" class="text-xs text-gray-400 hover:text-blue-300 transition-colors flex items-center gap-1">
            <i class="fas fa-microphone"></i> Voice
          </button>
          <button onclick="clearChat()" class="text-xs text-gray-400 hover:text-red-300 transition-colors flex items-center gap-1">
            <i class="fas fa-trash"></i> Clear
          </button>
        </div>
      </div>

      <!-- Status -->
      <div id="chat-status" class="text-xs text-gray-400 mt-3 flex items-center justify-center">
        <div id="typing-indicator" class="hidden items-center space-x-1">
          <span class="animate-bounce">‚óè</span>
          <span class="animate-bounce" style="animation-delay: 0.2s">‚óè</span>
          <span class="animate-bounce" style="animation-delay: 0.4s">‚óè</span>
          <span class="ml-2">AI is typing...</span>
        </div>
      </div>
    </div>
  </div>
</div>
      
      <!-- Founder Credit -->
      <div class="mb-24 pt-8 text-center">
        <p class="text-gray-400 text-sm mb-2">
          <span class="font-semibold">Founder &amp; Developer:</span> St Crijoh Studios.
        </p>
        <img
          src="StCrijoh_logo.png"
          alt="St Crijoh Studios Logo"
          class="mx-auto w-12 h-12 opacity-80 hover:opacity-100 transition-opacity"
          loading="lazy"
          onerror="this.style.display='none'"
        />
      </div>
    </div>
    
    <!-- Detailed Weather Forecast Modal -->
    <div id="weather-detail-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
      <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl w-full max-w-4xl max-h-[90%] overflow-auto slide-in border border-white/20">
        <div class="p-5">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-white" id="weather-detail-title">Weather Details</h2>
            <button onclick="hideWeatherDetail()" class="text-gray-400 hover:text-white p-1">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          
          <div id="weather-detail-content">
            <!-- Detailed weather content will be loaded here -->
          </div>
        </div>
      </div>
    </div>
    
    <!-- Cart Modal -->
    <div id="cart-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
      <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl w-full max-w-md max-h-[90%] overflow-auto slide-in border border-white/20">
        <div class="p-5">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-white">üõí Your Cart</h2>
            <button onclick="hideCart()" class="text-gray-400 hover:text-white p-1">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          <div id="cart-items" class="space-y-2 max-h-48 overflow-auto mb-4">
            <p class="text-gray-400 text-center py-4">Cart is empty</p>
          </div>
          <div class="border-t border-white/20 pt-4 mb-4">
            <div class="flex justify-between text-white font-bold text-xl">
              <span>Total:</span>
              <span id="cart-total">R0.00</span>
            </div>
          </div>
          
          <!-- Payment Section -->
          <div id="payment-section" class="hidden">
            <h3 class="text-lg font-semibold text-white mb-3">Payment</h3>
            <div class="mb-3">
              <label for="payment-amount" class="block text-sm text-gray-300 mb-1">Amount You Have (R)</label>
              <input type="number" id="payment-amount" min="0" step="0.01" placeholder="Enter amount" class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-emerald-500">
            </div>
            <div id="payment-result" class="hidden mb-4 p-4 rounded-xl"></div>
            <div class="flex gap-2">
              <button onclick="calculateChange()" class="flex-1 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-semibold transition-all">Calculate Change</button>
              <button id="complete-btn" onclick="completeOrder()" disabled class="flex-1 py-3 bg-emerald-500 hover:bg-emerald-600 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-xl font-semibold transition-all">Save</button>
            </div>
          </div>
          <button id="checkout-btn" onclick="showPayment()" class="w-full py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-xl font-semibold transition-all hidden">Proceed</button>
        </div>
      </div>
    </div>
    
    <!-- History Modal -->
    <div id="history-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
      <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl w-full max-w-lg max-h-[90%] overflow-auto slide-in border border-white/20">
        <div class="p-5">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-white">üìã Order History</h2>
            <button onclick="hideHistory()" class="text-gray-400 hover:text-white p-1">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          <div id="history-list" class="space-y-3 max-h-96 overflow-auto">
            <p class="text-gray-400 text-center py-8">No order history yet</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Import List Modal -->
    <div id="import-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
      <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl w-full max-w-md slide-in border border-white/20">
        <div class="p-5">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-white">üìù Import Shopping List</h2>
            <button onclick="hideImportModal()" class="text-gray-400 hover:text-white p-1">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          <p class="text-gray-300 text-sm mb-3">Paste your list in these formats:</p>
          <div class="bg-white/5 rounded-lg p-3 mb-4 text-xs font-mono text-gray-400">
            Milk 25.50<br>
            Bread R15<br>
            Eggs - 30.00<br>
            Cheese, 45
          </div>
          <form id="import-form" onsubmit="importList(event)">
            <textarea id="import-text" rows="8" placeholder="Paste your shopping list here..." class="w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none mb-4"></textarea>
            <div class="flex gap-2">
              <button type="button" onclick="hideImportModal()" class="flex-1 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-xl font-semibold transition-all">Cancel</button>
              <button type="submit" class="flex-1 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl font-semibold transition-all">Import Items</button>
            </div>
          </form>
        </div>
      </div>
    </div>
    
    <!-- Presets Modal -->
    <div id="presets-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
      <div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-2xl w-full max-w-md max-h-[90%] overflow-auto slide-in border border-white/20">
        <div class="p-5">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-xl font-bold text-white">‚≠ê Quick Add Presets</h2>
            <button onclick="hidePresetsModal()" class="text-gray-400 hover:text-white p-1">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          </div>
          
          <!-- Add New Preset Form -->
          <div class="bg-white/5 rounded-xl p-4 mb-4 border border-white/10">
            <h3 class="text-white font-semibold mb-3">Create New Preset</h3>
            <form id="preset-form" onsubmit="savePresetFromModal(event)" class="space-y-3">
              <div>
                <label for="preset-name" class="block text-sm text-gray-300 mb-1">Item Name</label>
                <input type="text" id="preset-name" required placeholder="e.g., Milk" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500">
              </div>
              <div>
                <label for="preset-price" class="block text-sm text-gray-300 mb-1">Price (R)</label>
                <input type="number" id="preset-price" required min="0.01" step="0.01" placeholder="0.00" class="w-full px-3 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500">
              </div>
              <button type="submit" class="w-full py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-semibold transition-all">üíæ Save Preset</button>
            </form>
          </div>
          
          <!-- Saved Presets List -->
          <div>
            <h3 class="text-white font-semibold mb-2">Saved Presets</h3>
            <div id="presets-list" class="space-y-2 max-h-64 overflow-auto">
              <p class="text-gray-400 text-center py-4 text-sm">No presets saved yet</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-emerald-500 text-white px-6 py-3 rounded-xl font-medium shadow-lg hidden z-50 fade-in">
      Item added to cart!
    </div>
    
    <!-- Fixed Bottom Statement Banner -->
    <div class="fixed bottom-0 left-0 right-0 bg-gradient-to-r from-purple-600 via-blue-600 to-emerald-600 text-white py-3 px-4 shadow-lg z-50">
      <p class="text-center text-sm md:text-base font-medium"><strong>BigTree Shopping Cart</strong> - Your smart shopping companion for easy checkout and order tracking</p>
    </div>
  </div>

  <!-- Fixed AI Assistant Robot (Bottom Right Corner) -->
  <div id="fixed-robot" class="fixed bottom-20 right-4 z-50">
    <div class="relative group">
      <div onclick="toggleRobotAssistant()" class="cursor-pointer transition-all hover:scale-110 active:scale-95">
        <div class="robot-tooltip absolute -top-12 right-0 bg-gray-800 text-white px-3 py-2 rounded-lg text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap z-50 border border-gray-700 shadow-lg">
          <i class="fas fa-robot mr-2"></i>Click for AI Assistant
          <div class="absolute -bottom-1 right-4 w-3 h-3 bg-gray-800 transform rotate-45"></div>
        </div>
        <img src="Robot.png" alt="AI Assistant" class="w-20 h-20 rounded-full border-4 border-blue-500/70 shadow-2xl hover:border-blue-400 transition-all duration-300">
        <div id="robot-status" class="absolute top-2 right-2 w-3 h-3 bg-green-500 rounded-full animate-pulse border-2 border-white shadow"></div>
      </div>
    </div>
  </div>

  <div id="robot-thought" class="fixed top-0 left-1/2 transform -translate-x-1/2 bg-black/80 text-white px-4 py-2 rounded-lg text-sm hidden z-50">
    <div class="flex items-center">
      <div class="animate-pulse mr-2">ü§î</div>
      <span>Thinking...</span>
    </div>
  </div>

  <script>
    // Preloader function
    function hidePreloader() {
      const preloader = document.getElementById('preloader');
      const app = document.getElementById('app');
      
      // Hide preloader after 0.5 seconds
      setTimeout(() => {
        preloader.style.opacity = '0';
        setTimeout(() => {
          preloader.style.display = 'none';
          app.classList.remove('hidden');
          // Load weather data after app loads
          loadWeatherData();
        }, 300); // Match the CSS transition time
      }, 500); // 0.5 seconds for the loader
    }

    // Menu toggle function
    function toggleMenu() {
      const menuPanel = document.getElementById('menuPanel');
      const menuBackdrop = document.getElementById('menuBackdrop');
      
      if (menuPanel.classList.contains('hidden')) {
        menuPanel.classList.remove('hidden');
        menuBackdrop.style.display = 'block';
        hideRobot(); // Hide robot when menu opens
      } else {
        closeMenu();
      }
    }

    // Close menu function
    function closeMenu() {
      const menuPanel = document.getElementById('menuPanel');
      const menuBackdrop = document.getElementById('menuBackdrop');
      
      menuPanel.classList.add('hidden');
      menuBackdrop.style.display = 'none';
      showRobot(); // Show robot when menu closes
    }

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
      const menuPanel = document.getElementById('menuPanel');
      const menuButton = document.querySelector('button[onclick="toggleMenu()"]');
      const menuBackdrop = document.getElementById('menuBackdrop');
      
      if (!menuPanel.classList.contains('hidden') && 
          !menuPanel.contains(event.target) && 
          !menuButton.contains(event.target)) {
        menuPanel.classList.add('hidden');
        menuBackdrop.style.display = 'none';
        showRobot(); // Show robot when menu closes
      }
    });

    // Close menu when pressing Escape key
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        const menuPanel = document.getElementById('menuPanel');
        if (!menuPanel.classList.contains('hidden')) {
          closeMenu();
        }
      }
    });

    // Cart state
    let cart = [];
    let orderHistory = [];
    let currentPaymentValid = false;
    let currentChange = 0;
    let presets = [];
    let recognition = null;

    // Weather state
    let weatherData = null;
    let weatherUseMetric = true;
    let weatherLocation = 'Johannesburg, ZA';
    let dailyForecastDetails = {};

    // Weather API Configuration
    const WEATHER_API_KEY = 'e9f0be03ab86589306cfb9795b2191cb'; // stcrijohstudio api key
    const WEATHER_BASE_URL = 'https://api.openweathermap.org/data/2.5';

    // AI Assistant state
    let isRobotActive = false;
    let chatHistory = [];
    let speechRecognitionActive = false;
    let speechRecognition = null;

    // Robot visibility state
    let robotVisible = true;

    // Quantity controls
    function incrementQuantity() {
      const quantityInput = document.getElementById('item-quantity');
      quantityInput.value = parseInt(quantityInput.value) + 1;
    }

    function decrementQuantity() {
      const quantityInput = document.getElementById('item-quantity');
      const currentValue = parseInt(quantityInput.value);
      if (currentValue > 1) {
        quantityInput.value = currentValue - 1;
      }
    }

    // Robot visibility functions
    function hideRobot() {
      const robot = document.getElementById('fixed-robot');
      robot.style.display = 'none';
      robotVisible = false;
    }

    function showRobot() {
      const robot = document.getElementById('fixed-robot');
      robot.style.display = 'block';
      robotVisible = true;
    }

    function checkRobotVisibility() {
      // Check if any modal is open
      const cartModal = document.getElementById('cart-modal');
      const historyModal = document.getElementById('history-modal');
      const importModal = document.getElementById('import-modal');
      const presetsModal = document.getElementById('presets-modal');
      const weatherModal = document.getElementById('weather-detail-modal');
      const robotModal = document.getElementById('robot-modal');
      const menuPanel = document.getElementById('menuPanel');
      
      // If any modal is open or menu is open, hide robot
      if (!cartModal.classList.contains('hidden') ||
          !historyModal.classList.contains('hidden') ||
          !importModal.classList.contains('hidden') ||
          !presetsModal.classList.contains('hidden') ||
          !weatherModal.classList.contains('hidden') ||
          !robotModal.classList.contains('hidden') ||
          !menuPanel.classList.contains('hidden')) {
        hideRobot();
      } else {
        showRobot();
      }
    }

    // Load data from localStorage on startup
    function loadData() {
      const savedCart = localStorage.getItem('bigtree-cart');
      const savedHistory = localStorage.getItem('bigtree-history');
      const savedPresets = localStorage.getItem('bigtree-presets');

      if (savedCart) {
        try {
          cart = JSON.parse(savedCart);
          updateCartBadge();
          updateCartPreview();
        } catch (e) {
          cart = [];
        }
      }

      if (savedHistory) {
        try {
          orderHistory = JSON.parse(savedHistory);
        } catch (e) {
          orderHistory = [];
        }
      }

      if (savedPresets) {
        try {
          presets = JSON.parse(savedPresets);
        } catch (e) {
          presets = [];
        }
      }
    }

    // Save data to localStorage
    function saveCart() {
      localStorage.setItem('bigtree-cart', JSON.stringify(cart));
    }

    function saveHistory() {
      localStorage.setItem('bigtree-history', JSON.stringify(orderHistory));
    }

    function savePresets() {
      localStorage.setItem('bigtree-presets', JSON.stringify(presets));
    }

    // Voice input
    function startVoiceInput(fieldId) {
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        showToast('Voice input not supported in your browser');
        return;
      }

      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SpeechRecognition();
      recognition.lang = 'en-US';
      recognition.continuous = false;
      recognition.interimResults = false;

      const field = document.getElementById(fieldId);
      const button = window.event ? window.event.target.closest('button') : null;
      
      if (button) {
        button.classList.add('text-red-500');
      }
      showToast('üé§ Listening...');

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        
        if (fieldId === 'item-price') {
          const numbers = transcript.match(/\d+\.?\d*/);
          if (numbers) {
            field.value = numbers[0];
          }
        } else {
          field.value = transcript;
        }
        
        if (button) {
          button.classList.remove('text-red-500');
        }
        showToast('‚úì Voice input captured!');
      };

      recognition.onerror = (err) => {
        if (button) {
          button.classList.remove('text-red-500');
        }
        
        if (err.error === 'not-allowed' || err.error === 'permission-denied') {
          showToast('Microphone permission denied');
        } else if (err.error === 'no-speech') {
          showToast('No speech detected. Try again.');
        } else {
          showToast('Voice input failed. Try typing.');
        }
      };

      recognition.onend = () => {
        if (button) {
          button.classList.remove('text-red-500');
        }
      };

      try {
        recognition.start();
      } catch (e) {
        showToast('Voice input unavailable');
        if (button) {
          button.classList.remove('text-red-500');
        }
      }
    }

    // Save current form as preset
    function saveAsPreset() {
      const nameInput = document.getElementById('item-name');
      const priceInput = document.getElementById('item-price');

      if (!nameInput.value || !priceInput.value) {
        showToast('Fill in both fields to save preset');
        return;
      }

      const preset = {
        id: Date.now().toString(),
        name: nameInput.value.trim(),
        price: parseFloat(priceInput.value)
      };

      presets.push(preset);
      savePresets();
      showToast('‚≠ê Preset saved!');
    }

    // Save preset from modal form
    function savePresetFromModal(e) {
      e.preventDefault();
      const nameInput = document.getElementById('preset-name');
      const priceInput = document.getElementById('preset-price');

      const preset = {
        id: Date.now().toString(),
        name: nameInput.value.trim(),
        price: parseFloat(priceInput.value)
      };

      presets.push(preset);
      savePresets();
      renderPresets();
      
      nameInput.value = '';
      priceInput.value = '';
      
      showToast('Preset saved!‚≠ê');
    }

    // Show/hide presets modal
    function showPresetsModal() {
      renderPresets();
      document.getElementById('presets-modal').classList.remove('hidden');
      checkRobotVisibility();
    }

    function hidePresetsModal() {
      document.getElementById('presets-modal').classList.add('hidden');
      checkRobotVisibility();
    }

    // Render presets list
    function renderPresets() {
      const presetsList = document.getElementById('presets-list');

      if (presets.length === 0) {
        presetsList.innerHTML = '<p class="text-gray-400 text-center py-4 text-sm">No presets saved yet</p>';
        return;
      }

      presetsList.innerHTML = presets.map(preset => `
        <div class="flex items-center justify-between bg-white/5 rounded-lg p-3 hover:bg-white/10 transition-all">
          <div class="flex-1 cursor-pointer" onclick="addPresetToCart('${preset.id}')">
            <p class="text-white font-medium">${escapeHtml(preset.name)}</p>
            <p class="text-purple-400 text-sm">R${preset.price.toFixed(2)}</p>
          </div>
          <button onclick="deletePreset('${preset.id}')" class="text-red-400 hover:text-red-300 p-1 ml-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
          </button>
        </div>
      `).join('');
    }

    // Add preset to cart
    function addPresetToCart(presetId) {
      const preset = presets.find(p => p.id === presetId);
      if (!preset) return;

      // Check if item already exists in cart
      const existingItem = cart.find(item => item.name === preset.name && item.price === preset.price);
      
      if (existingItem) {
        existingItem.quantity += 1;
      } else {
        cart.push({
          id: Date.now().toString() + Math.random(),
          name: preset.name,
          price: preset.price,
          quantity: 1
        });
      }

      saveCart();
      updateCartBadge();
      updateCartPreview();
      showToast('‚úì Added from preset!');
      hidePresetsModal();
    }

    // Delete preset
    function deletePreset(presetId) {
      presets = presets.filter(p => p.id !== presetId);
      savePresets();
      renderPresets();
      showToast('Preset deleted');
    }

    // Show/hide import modal
    function showImportModal() {
      document.getElementById('import-modal').classList.remove('hidden');
      checkRobotVisibility();
    }

    function hideImportModal() {
      document.getElementById('import-modal').classList.add('hidden');
      document.getElementById('import-text').value = '';
      checkRobotVisibility();
    }

    // Import list from text
    function importList(e) {
      e.preventDefault();
      const text = document.getElementById('import-text').value.trim();
      
      if (!text) {
        showToast('Please paste a list first');
        return;
      }

      const lines = text.split('\n').filter(line => line.trim());
      let imported = 0;

      lines.forEach(line => {
        const patterns = [
          /^(.+?)\s+R?([0-9.]+)$/,
          /^(.+?)\s*[-,:]\s*R?([0-9.]+)$/
        ];

        for (const pattern of patterns) {
          const match = line.trim().match(pattern);
          if (match) {
            const name = match[1].trim().replace(/^R/, '').trim();
            const price = parseFloat(match[2]);

            if (name && price > 0) {
              // Check if item already exists in cart
              const existingItem = cart.find(item => item.name === name && item.price === price);
              
              if (existingItem) {
                existingItem.quantity += 1;
              } else {
                cart.push({
                  id: Date.now().toString() + Math.random(),
                  name: name,
                  price: price,
                  quantity: 1
                });
              }
              imported++;
            }
            break;
          }
        }
      });

      if (imported > 0) {
        saveCart();
        updateCartBadge();
        updateCartPreview();
        hideImportModal();
        showToast(`‚úì Imported ${imported} item${imported > 1 ? 's' : ''}!`);
      } else {
        showToast('Could not parse items. Check format.');
      }
    }

    function addToCart(e) {
      e.preventDefault();
      const nameInput = document.getElementById('item-name');
      const priceInput = document.getElementById('item-price');
      const quantityInput = document.getElementById('item-quantity');
      
      const quantity = parseInt(quantityInput.value);
      const name = nameInput.value.trim();
      const price = parseFloat(priceInput.value);
      
      // Check if item already exists in cart
      const existingItem = cart.find(item => item.name === name && item.price === price);
      
      if (existingItem) {
        existingItem.quantity += quantity;
      } else {
        const item = {
          id: Date.now().toString() + Math.random(),
          name: name,
          price: price,
          quantity: quantity
        };
        cart.push(item);
      }
      
      saveCart();
      nameInput.value = '';
      priceInput.value = '';
      quantityInput.value = '1';
      
      updateCartBadge();
      updateCartPreview();
      showToast(`${quantity} item${quantity > 1 ? 's' : ''} added to cart!`);
    }

    function updateCartBadge() {
      const badge = document.getElementById('cart-badge');
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      if (totalItems > 0) {
        badge.textContent = totalItems;
        badge.classList.remove('hidden');
        badge.classList.add('cart-badge');
      } else {
        badge.classList.add('hidden');
      }
    }

    function updateCartPreview() {
      const preview = document.getElementById('cart-preview');
      const totalPreview = document.getElementById('cart-total-preview');
      const previewTotal = document.getElementById('preview-total');

      if (cart.length === 0) {
        preview.innerHTML = '<p class="text-gray-400 text-center py-4">Your cart is empty</p>';
        totalPreview.classList.add('hidden');
        return;
      }

      preview.innerHTML = cart.map((item, index) => `
        <div class="flex items-center justify-between bg-white/5 rounded-lg p-3 fade-in">
          <div class="flex-1">
            <p class="text-white font-medium">${escapeHtml(item.name)} ${item.quantity > 1 ? `<span class="text-gray-400">√ó${item.quantity}</span>` : ''}</p>
            <p class="text-emerald-400 text-sm">R${item.price.toFixed(2)}${item.quantity > 1 ? ` each ‚Ä¢ <span class="font-semibold">R${(item.price * item.quantity).toFixed(2)}</span> total` : ''}</p>
          </div>
          <button onclick="removeFromCart('${item.id}')" class="text-red-400 hover:text-red-300 p-1">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
            </svg>
          </button>
        </div>
      `).join('');

      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      previewTotal.textContent = `R${total.toFixed(2)}`;
      totalPreview.classList.remove('hidden');
    }

    function removeFromCart(itemId) {
      cart = cart.filter(item => item.id !== itemId);
      saveCart();
      updateCartBadge();
      updateCartPreview();
    }

    function showCart() {
      updateCartModal();
      document.getElementById('cart-modal').classList.remove('hidden');
      document.getElementById('payment-section').classList.add('hidden');
      document.getElementById('checkout-btn').classList.toggle('hidden', cart.length === 0);
      document.getElementById('payment-result').classList.add('hidden');
      document.getElementById('payment-amount').value = '';
      currentPaymentValid = false;
      document.getElementById('complete-btn').disabled = true;
      checkRobotVisibility();
    }

    function hideCart() {
      document.getElementById('cart-modal').classList.add('hidden');
      checkRobotVisibility();
    }

    function updateCartModal() {
      const cartItems = document.getElementById('cart-items');
      const cartTotal = document.getElementById('cart-total');
      const checkoutBtn = document.getElementById('checkout-btn');

      if (cart.length === 0) {
        cartItems.innerHTML = '<p class="text-gray-400 text-center py-4">Cart is empty</p>';
        cartTotal.innerHTML = 'R0.00';
        checkoutBtn.classList.add('hidden');
        return;
      }

      cartItems.innerHTML = cart.map(item => `
        <div class="bg-white/5 rounded-lg p-3">
          <div class="flex items-center justify-between mb-2">
            <p class="text-white font-medium">${escapeHtml(item.name)} ${item.quantity > 1 ? `<span class="text-gray-400">√ó${item.quantity}</span>` : ''}</p>
            <button onclick="removeFromCart('${item.id}'); updateCartModal();" class="text-red-400 hover:text-red-300 p-1">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
          <div class="flex items-center justify-between text-sm">
            <span class="text-gray-400">R${item.price.toFixed(2)} each</span>
            <span class="text-emerald-400 font-semibold">R${(item.price * item.quantity).toFixed(2)}</span>
          </div>
        </div>
      `).join('');

      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      cartTotal.innerHTML = `R${total.toFixed(2)}`;
      checkoutBtn.classList.remove('hidden');
    }

    function showPayment() {
      document.getElementById('payment-section').classList.remove('hidden');
      document.getElementById('checkout-btn').classList.add('hidden');
    }

    function calculateChange() {
      const paymentInput = document.getElementById('payment-amount');
      const resultDiv = document.getElementById('payment-result');
      const completeBtn = document.getElementById('complete-btn');
      
      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      const payment = parseFloat(paymentInput.value) || 0;

      resultDiv.classList.remove('hidden');

      if (payment < total) {
        const shortage = total - payment;
        resultDiv.className = 'mb-4 p-4 rounded-xl bg-red-500/20 border border-red-500/50';
        resultDiv.innerHTML = `
          <p class="text-red-400 font-semibold">‚ùå Insufficient Payment</p>
          <p class="text-white">Short by: R${shortage.toFixed(2)}</p>
        `;
        currentPaymentValid = false;
        completeBtn.disabled = true;
      } else {
        currentChange = payment - total;
        resultDiv.className = 'mb-4 p-4 rounded-xl bg-emerald-500/20 border border-emerald-500/50';
        resultDiv.innerHTML = `
          <p class="text-emerald-400 font-semibold">‚úÖ Change you expect to receive</p>
          <p class="text-white">R${currentChange.toFixed(2)}</p>
        `;
        currentPaymentValid = true;
        completeBtn.disabled = false;
      }
    }

    function completeOrder() {
      if (!currentPaymentValid || cart.length === 0) return;

      const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
      const payment = parseFloat(document.getElementById('payment-amount').value);

      const order = {
        id: `ORD-${Date.now()}`,
        items: cart.map(i => ({ name: i.name, price: i.price, quantity: i.quantity })),
        total: total,
        paid: payment,
        change: currentChange,
        date: new Date().toISOString()
      };

      orderHistory.push(order);
      saveHistory();

      cart = [];
      saveCart();
      updateCartBadge();
      updateCartPreview();
      hideCart();
      showToast('‚úÖ Task saved in history');
    }

    function showHistory() {
      renderHistory();
      document.getElementById('history-modal').classList.remove('hidden');
      checkRobotVisibility();
    }

    function hideHistory() {
      document.getElementById('history-modal').classList.add('hidden');
      checkRobotVisibility();
    }

    function renderHistory() {
      const historyList = document.getElementById('history-list');

      if (orderHistory.length === 0) {
        historyList.innerHTML = '<p class="text-gray-400 text-center py-8">No order history yet</p>';
        return;
      }

      const sorted = [...orderHistory].sort((a, b) => new Date(b.date) - new Date(a.date));

      historyList.innerHTML = sorted.map(order => {
        const date = new Date(order.date);
        const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

        return `
          <div class="bg-white/5 rounded-xl p-4 border border-white/10">
            <div class="flex justify-between items-start mb-2">
              <span class="text-emerald-400 font-mono text-sm">${order.id}</span>
              <span class="text-gray-400 text-xs">${dateStr}</span>
            </div>
            <div class="space-y-1 mb-3">
              ${order.items.map(item => `
                <div class="flex justify-between text-sm">
                  <span class="text-gray-300">${escapeHtml(item.name)} ${item.quantity > 1 ? `√ó${item.quantity}` : ''}</span>
                  <span class="text-white">R${((item.price * (item.quantity || 1)).toFixed(2))}</span>
                </div>
              `).join('')}
            </div>
            <div class="border-t border-white/10 pt-2 space-y-1 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-400">Total:</span>
                <span class="text-white font-semibold">R${order.total.toFixed(2)}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-400">Paid:</span>
                <span class="text-white">R${order.paid.toFixed(2)}</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-400">Change:</span>
                <span class="text-emerald-400">R${order.change.toFixed(2)}</span>
              </div>
            </div>
            <div class="mt-3 flex gap-2">
              <button onclick="printOrder('${order.id}')" class="flex-1 py-2 bg-blue-500/20 hover:bg-blue-500/30 text-blue-400 rounded-lg text-sm transition-all flex items-center justify-center gap-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                </svg>
                Print
              </button>
              <button onclick="deleteOrder('${order.id}')" class="flex-1 py-2 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded-lg text-sm transition-all flex items-center justify-center gap-1">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                </svg>
                Delete
              </button>
            </div>
          </div>
        `;
      }).join('');
    }

    function printOrder(orderId) {
      const order = orderHistory.find(o => o.id === orderId);
      if (!order) return;

      const date = new Date(order.date);
      const dateStr = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

      const printContent = `
<!DOCTYPE html>
<html>
<head>
  <title>BigTree Shopping Cart - Receipt</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      max-width: 600px;
      margin: 0 auto;
      color: #333;
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header img {
      width: 80px;
      margin-bottom: 10px;
    }

    .header h1 {
      margin: 0;
      font-size: 26px;
      color: #10b981;
    }

    .header p {
      margin: 4px 0 0;
      font-size: 14px;
      color: #666;
    }

    .order-info {
      margin: 20px 0;
      font-size: 14px;
      color: #555;
    }

    .items {
      margin: 20px 0;
    }

    .item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }

    .totals {
      margin-top: 20px;
      border-top: 2px solid #10b981;
      padding-top: 10px;
    }

    .total-row {
      display: flex;
      justify-content: space-between;
      padding: 6px 0;
      font-size: 14px;
    }

    .total-row.final {
      font-weight: bold;
      font-size: 18px;
      color: #10b981;
    }

    .footer {
      margin-top: 30px;
      text-align: center;
      font-size: 12px;
      color: #777;
    }

    /* Add to your existing styles */
::-webkit-scrollbar {
  height: 6px;
}

::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.3);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.5);
}
  </style>
</head>
<body>

  <!-- Header -->
  <div class="header">
    <img src="BigTree_logo.png" alt="BigTree Logo">
    <h1>BigTree Shopping Cart</h1>
    <p>Your smart shopping companion</p>
  </div>

  <!-- Order Info -->
  <div class="order-info">
    <strong>Order ID:</strong> ${order.id}<br>
    <strong>Date:</strong> ${dateStr}
  </div>

  <!-- Items -->
  <div class="items">
    <h2>Items</h2>
    ${order.items.map(item => `
      <div class="item">
        <span>${escapeHtml(item.name)} ${item.quantity > 1 ? `√ó${item.quantity}` : ''}</span>
        <span>R${((item.price * (item.quantity || 1)).toFixed(2))}</span>
      </div>
    `).join('')}
  </div>

  <!-- Totals -->
  <div class="totals">
    <div class="total-row">
      <span>Total:</span>
      <span>R${order.total.toFixed(2)}</span>
    </div>
    <div class="total-row">
      <span>Paid:</span>
      <span>R${order.paid.toFixed(2)}</span>
    </div>
    <div class="total-row final">
      <span>Change:</span>
      <span>R${order.change.toFixed(2)}</span>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p>Thank you for shopping with BigTree </p>
    <p>St Crijoh Studios</p>
  </div>

</body>
</html>
`;


      const printWindow = window.open('', '_blank');
      if (printWindow) {
        printWindow.document.write(printContent);
        printWindow.document.close();
        printWindow.focus();
        setTimeout(() => {
          printWindow.print();
        }, 250);
      }
    }

    function deleteOrder(orderId) {
      orderHistory = orderHistory.filter(o => o.id !== orderId);
      saveHistory();
      renderHistory();
      showToast('Order deleted');
    }

    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.remove('hidden');
      setTimeout(() => toast.classList.add('hidden'), 2500);
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // ======================
    // WEATHER FUNCTIONS - FIXED
    // ======================

    // Load weather data
    async function loadWeatherData() {
      try {
        // First try to get user's location
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            async (position) => {
              const { latitude, longitude } = position.coords;
              await fetchWeatherByCoords(latitude, longitude);
            },
            async (error) => {
              console.error('Geolocation error:', error);
              // Fallback to Johannesburg
              await fetchWeatherByCity('Johannesburg, ZA');
            }
          );
        } else {
          // Fallback to Johannesburg if geolocation not supported
          await fetchWeatherByCity('Johannesburg, ZA');
        }
      } catch (error) {
        console.error('Error loading weather data:', error);
        showToast('Failed to load weather data');
      }
    }

    // Fetch weather by city name
    async function fetchWeatherByCity(city) {
      try {
        weatherLocation = city;
        
        // Fetch current weather and forecast
        const [currentResponse, forecastResponse] = await Promise.all([
          fetch(`${WEATHER_BASE_URL}/weather?q=${city}&appid=${WEATHER_API_KEY}&units=${weatherUseMetric ? 'metric' : 'imperial'}`),
          fetch(`${WEATHER_BASE_URL}/forecast?q=${city}&appid=${WEATHER_API_KEY}&units=${weatherUseMetric ? 'metric' : 'imperial'}`)
        ]);

        if (!currentResponse.ok || !forecastResponse.ok) {
          throw new Error('Weather data not available');
        }

        const currentData = await currentResponse.json();
        const forecastData = await forecastResponse.json();

        weatherData = {
          current: currentData,
          forecast: forecastData
        };

        updateWeatherDisplay();
        showToast('Weather updated!');
        
      } catch (error) {
        console.error('Error fetching weather:', error);
        showToast('Could not load weather data');
      }
    }

    // Fetch weather by coordinates
    async function fetchWeatherByCoords(lat, lon) {
      try {
        // Fetch current weather and forecast
        const [currentResponse, forecastResponse] = await Promise.all([
          fetch(`${WEATHER_BASE_URL}/weather?lat=${lat}&lon=${lon}&appid=${WEATHER_API_KEY}&units=${weatherUseMetric ? 'metric' : 'imperial'}`),
          fetch(`${WEATHER_BASE_URL}/forecast?lat=${lat}&lon=${lon}&appid=${WEATHER_API_KEY}&units=${weatherUseMetric ? 'metric' : 'imperial'}`)
        ]);

        if (!currentResponse.ok || !forecastResponse.ok) {
          throw new Error('Weather data not available');
        }

        const currentData = await currentResponse.json();
        const forecastData = await forecastResponse.json();

        weatherData = {
          current: currentData,
          forecast: forecastData
        };

        weatherLocation = `${currentData.name}, ${currentData.sys.country}`;
        updateWeatherDisplay();
        showToast('Weather updated!');
        
      } catch (error) {
        console.error('Error fetching weather:', error);
        showToast('Could not load weather data');
      }
    }

    // Update weather display
    function updateWeatherDisplay() {
      if (!weatherData) return;

      const locationElement = document.getElementById('weather-location');
      const updatedElement = document.getElementById('weather-updated');
      const unitElement = document.getElementById('weather-unit');
      const forecastContainer = document.getElementById('weather-forecast');

      // Update location and time
      locationElement.textContent = weatherLocation;
      updatedElement.textContent = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
      unitElement.textContent = weatherUseMetric ? '¬∞C' : '¬∞F';

      // Update 5-day forecast
      update5DayForecast(weatherData.forecast.list);
    }

    // Update 5-day forecast display - FIXED VERSION
    function update5DayForecast(forecastData) {
      const container = document.getElementById('weather-forecast');
      if (!container) return;

      // Group by day - using local date
      const dailyData = {};

      forecastData.forEach(item => {
        const date = new Date(item.dt * 1000);
        // Get local date string (YYYY-MM-DD) to avoid timezone issues
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const dayKey = `${year}-${month}-${day}`;
        
        if (!dailyData[dayKey]) {
          dailyData[dayKey] = {
            date: new Date(year, date.getMonth(), date.getDate()), // Create date without time
            temps: [],
            humidity: [],
            wind: [],
            weather: [],
            items: []
          };
        }
        
        dailyData[dayKey].temps.push(item.main.temp);
        dailyData[dayKey].humidity.push(item.main.humidity);
        dailyData[dayKey].wind.push(item.wind.speed);
        dailyData[dayKey].weather.push(item.weather[0]);
        dailyData[dayKey].items.push(item);
      });

      // Store for detailed view
      dailyForecastDetails = dailyData;

      // Get next 5 days starting from today at local time
      const today = new Date();
      today.setHours(0, 0, 0, 0); // Set to beginning of day
      
      const next5Days = [];
      
      for (let i = 0; i < 5; i++) {
        const date = new Date(today);
        date.setDate(today.getDate() + i);
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const dayKey = `${year}-${month}-${day}`;
        
        next5Days.push({ 
          date: new Date(date), 
          dayKey: dayKey, 
          data: dailyData[dayKey] 
        });
      }

      // Generate HTML for forecast cards
      container.innerHTML = next5Days.map(day => {
        const data = day.data;
        if (!data) {
          // No data for this day
          const dayName = day.date.toLocaleDateString('en-US', { weekday: 'short' });
          const dateStr = day.date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
          
          return `
            <div class="weather-card rounded-xl p-4 text-center cursor-not-allowed opacity-50">
              <p class="font-medium text-gray-300">${dayName}</p>
              <p class="text-sm text-gray-400 mb-3">${dateStr}</p>
              <div class="text-3xl mb-2 text-gray-500">
                <i class="fas fa-question-circle"></i>
              </div>
              <p class="text-gray-400 text-sm">No data</p>
            </div>
          `;
        }

        const high = Math.round(Math.max(...data.temps));
        const low = Math.round(Math.min(...data.temps));
        const avgHumidity = Math.round(data.humidity.reduce((a, b) => a + b, 0) / data.humidity.length);
        const maxWind = Math.max(...data.wind).toFixed(1);
        const mainWeather = data.weather[0]; // Use first weather reading for icon
        
        const dayName = day.date.toLocaleDateString('en-US', { weekday: 'short' });
        const dateStr = day.date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        const tempUnit = weatherUseMetric ? '¬∞C' : '¬∞F';
        const speedUnit = weatherUseMetric ? 'm/s' : 'mph';

        return `
          <div class="weather-card rounded-xl p-4 text-center cursor-pointer hover:bg-white/10 transition-all" 
               onclick="showWeatherDetail('${day.dayKey}')">
            <p class="font-medium text-white">${dayName}</p>
            <p class="text-sm text-gray-400 mb-3">${dateStr}</p>
            <div class="text-3xl mb-2">
              ${getWeatherIcon(mainWeather.icon)}
            </div>
            <p class="text-2xl font-bold temp-gradient mb-1">${high}${tempUnit}</p>
            <p class="text-gray-400 text-sm mb-2">Low: ${low}${tempUnit}</p>
            <div class="grid grid-cols-2 gap-1 text-xs text-gray-300">
              <div>
                <i class="fas fa-tint mr-1"></i>
                <span>${avgHumidity}%</span>
              </div>
              <div>
                <i class="fas fa-wind mr-1"></i>
                <span>${maxWind} ${speedUnit}</span>
              </div>
            </div>
            <p class="text-xs text-blue-400 mt-2">Click for details</p>
          </div>
        `;
      }).join('');
    }

    // Get weather icon based on condition
    function getWeatherIcon(iconCode) {
      const icons = {
        '01d': '<i class="fas fa-sun text-yellow-400"></i>',
        '01n': '<i class="fas fa-moon text-blue-300"></i>',
        '02d': '<i class="fas fa-cloud-sun text-yellow-300"></i>',
        '02n': '<i class="fas fa-cloud-moon text-blue-300"></i>',
        '03d': '<i class="fas fa-cloud text-gray-300"></i>',
        '03n': '<i class="fas fa-cloud text-gray-300"></i>',
        '04d': '<i class="fas fa-cloud text-gray-400"></i>',
        '04n': '<i class="fas fa-cloud text-gray-400"></i>',
        '09d': '<i class="fas fa-cloud-rain text-blue-400"></i>',
        '09n': '<i class="fas fa-cloud-rain text-blue-400"></i>',
        '10d': '<i class="fas fa-cloud-sun-rain text-blue-500"></i>',
        '10n': '<i class="fas fa-cloud-moon-rain text-blue-500"></i>',
        '11d': '<i class="fas fa-bolt text-yellow-500"></i>',
        '11n': '<i class="fas fa-bolt text-yellow-500"></i>',
        '13d': '<i class="fas fa-snowflake text-blue-300"></i>',
        '13n': '<i class="fas fa-snowflake text-blue-300"></i>',
        '50d': '<i class="fas fa-smog text-gray-300"></i>',
        '50n': '<i class="fas fa-smog text-gray-300"></i>'
      };
      return icons[iconCode] || '<i class="fas fa-cloud text-gray-400"></i>';
    }

    // Show weather detail modal with improved hourly forecast - FIXED
    function showWeatherDetail(dayKey) {
      const data = dailyForecastDetails[dayKey];
      if (!data || !weatherData) return;

      const date = data.date;
      const dateStr = date.toLocaleDateString('en-US', { 
        weekday: 'long', 
        month: 'long', 
        day: 'numeric', 
        year: 'numeric' 
      });
      
      // Calculate statistics
      const high = Math.round(Math.max(...data.temps));
      const low = Math.round(Math.min(...data.temps));
      const avgTemp = Math.round(data.temps.reduce((a, b) => a + b, 0) / data.temps.length);
      const avgHumidity = Math.round(data.humidity.reduce((a, b) => a + b, 0) / data.humidity.length);
      const maxWind = Math.max(...data.wind).toFixed(1);
      const avgWind = (data.wind.reduce((a, b) => a + b, 0) / data.wind.length).toFixed(1);
      
      const tempUnit = weatherUseMetric ? '¬∞C' : '¬∞F';
      const speedUnit = weatherUseMetric ? 'm/s' : 'mph';
      
      // Create hourly data from the 3-hour intervals for this day
      const hourlyData = generateHourlyData(data.items, date);
      
      // Update modal title
      document.getElementById('weather-detail-title').textContent = `Weather Details - ${dateStr}`;

      // Update modal content
      const content = document.getElementById('weather-detail-content');
      content.innerHTML = `
        <div class="space-y-6">
          <!-- Daily Conditions Summary -->
          <div class="bg-white/5 rounded-xl p-4">
            <h3 class="font-semibold mb-3 text-lg text-blue-300">
              <i class="fas fa-chart-bar mr-2"></i>Daily Conditions
            </h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
              <div class="text-center">
                <p class="text-gray-400 text-sm">High Temp</p>
                <p class="text-2xl font-bold temp-gradient">${high}${tempUnit}</p>
              </div>
              <div class="text-center">
                <p class="text-gray-400 text-sm">Avg Humidity</p>
                <p class="text-2xl font-bold humidity-gradient">${avgHumidity}%</p>
              </div>
              <div class="text-center">
                <p class="text-gray-400 text-sm">Max Wind</p>
                <p class="text-2xl font-bold wind-gradient">${maxWind} ${speedUnit}</p>
              </div>
              <div class="text-center">
                <p class="text-gray-400 text-sm">Avg Temp</p>
                <p class="text-xl font-bold">${avgTemp}${tempUnit}</p>
              </div>
            </div>
            <div class="mt-4 grid grid-cols-2 gap-4">
              <div class="text-center">
                <p class="text-gray-400 text-sm">Low Temp</p>
                <p class="text-xl">${low}${tempUnit}</p>
              </div>
              <div class="text-center">
                <p class="text-gray-400 text-sm">Avg Wind</p>
                <p class="text-xl">${avgWind} ${speedUnit}</p>
              </div>
            </div>
          </div>

          <!-- 24-Hour Forecast -->
          <div class="bg-white/5 rounded-xl p-4">
            <h3 class="font-semibold mb-3 text-lg text-green-300">
              <i class="fas fa-clock mr-2"></i>24-Hour Forecast
            </h3>
            <div class="relative">
              <div class="flex overflow-x-auto gap-3 pb-4 px-2" style="scrollbar-width: thin;">
                ${hourlyData.map((hour, index) => {
                  const time = new Date(hour.time);
                  const hourString = time.getHours();
                  const ampm = hourString >= 12 ? 'PM' : 'AM';
                  const displayHour = hourString % 12 || 12;
                  
                  // Show every 3 hours for better readability
                  if (index % 3 === 0) {
                    return `
                      <div class="flex-shrink-0 w-20 bg-black/20 rounded-lg p-3">
                        <p class="text-sm font-medium text-center mb-2">${displayHour} ${ampm}</p>
                        <div class="my-2 text-2xl text-center">${getWeatherIcon(hour.icon)}</div>
                        <p class="text-center font-bold text-lg mb-1">${Math.round(hour.temp)}${tempUnit}</p>
                        <div class="space-y-1 text-xs">
                          <div class="flex justify-center">
                            <span class="text-blue-300">${hour.humidity}%</span>
                          </div>
                          <div class="flex justify-center">
                            <span class="text-green-300">${hour.wind} ${speedUnit}</span>
                          </div>
                        </div>
                      </div>
                    `;
                  }
                  return '';
                }).filter(Boolean).join('')}
              </div>
              <p class="text-xs text-gray-500 text-center mt-2">Scroll horizontally to see more hours ‚Üí</p>
            </div>
          </div>

          <!-- Weather Summary -->
          <div class="bg-white/5 rounded-xl p-4">
            <h3 class="font-semibold mb-3 text-lg text-yellow-300">
              <i class="fas fa-cloud-sun mr-2"></i>Weather Summary
            </h3>
            <div class="flex items-center gap-4 mb-4">
              <div class="text-4xl">
                ${getWeatherIcon(data.weather[0].icon)}
              </div>
              <div>
                <p class="text-lg font-medium">${data.weather[0].main}</p>
                <p class="text-gray-300">${data.weather[0].description.charAt(0).toUpperCase() + data.weather[0].description.slice(1)}</p>
              </div>
            </div>
            <div class="mt-4 grid grid-cols-2 md:grid-cols-3 gap-3">
              <div class="bg-black/20 rounded-lg p-3">
                <p class="text-gray-400 text-sm">UV Index</p>
                <p class="text-xl font-bold text-yellow-400">${Math.floor(Math.random() * 5) + 3}</p>
                <p class="text-xs text-gray-400">Moderate</p>
              </div>
              <div class="bg-black/20 rounded-lg p-3">
                <p class="text-gray-400 text-sm">Sunrise/Sunset</p>
                <p class="text-sm">6:30 AM / 6:45 PM</p>
                <p class="text-xs text-gray-400">Daylight hours</p>
              </div>
              <div class="bg-black/20 rounded-lg p-3">
                <p class="text-gray-400 text-sm">Pressure</p>
                <p class="text-xl">${data.items[0]?.main.pressure || 1013} hPa</p>
                <p class="text-xs text-gray-400">Sea level</p>
              </div>
            </div>
          </div>

          <!-- Shopping Tips -->
          <div class="bg-white/5 rounded-xl p-4">
            <h3 class="font-semibold mb-3 text-lg text-purple-300">
              <i class="fas fa-shopping-cart mr-2"></i>Shopping Tips for This Day
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <div class="bg-purple-900/20 rounded-lg p-3">
                <p class="text-sm font-medium text-purple-300">Based on temperature:</p>
                <p class="text-sm text-gray-300">${avgTemp > 25 ? 'Hot day - Perfect for cold drinks and ice cream shopping' : 
                  avgTemp < 10 ? 'Cold day - Stock up on warm foods and hot beverages' : 
                  'Pleasant day - Great for outdoor shopping trips'}</p>
              </div>
              <div class="bg-blue-900/20 rounded-lg p-3">
                <p class="text-sm font-medium text-blue-300">Based on conditions:</p>
                <p class="text-sm text-gray-300">${data.weather[0].main.includes('Rain') ? 'Rain expected - Consider indoor shopping or delivery services' : 
                  maxWind > 5 ? 'Windy conditions - Secure your shopping bags' : 
                  'Clear conditions - Perfect for any shopping activities'}</p>
              </div>
            </div>
          </div>
        </div>
      `;

      // Show the modal
      document.getElementById('weather-detail-modal').classList.remove('hidden');
      checkRobotVisibility();
    }

    // Generate hourly data from 3-hour intervals
    function generateHourlyData(threeHourData, targetDate) {
      if (!threeHourData || threeHourData.length === 0) return [];
      
      const hourlyData = [];
      
      // Create data for each hour from 0 to 23
      for (let hour = 0; hour < 24; hour++) {
        const hourTime = new Date(targetDate);
        hourTime.setHours(hour, 0, 0, 0);
        
        // Find the two closest 3-hour data points for interpolation
        const dataPoints = threeHourData.map(item => ({
          time: new Date(item.dt * 1000),
          temp: item.main.temp,
          humidity: item.main.humidity,
          wind: item.wind.speed,
          icon: item.weather[0].icon,
          weather: item.weather[0]
        })).sort((a, b) => Math.abs(a.time.getHours() - hour) - Math.abs(b.time.getHours() - hour));
        
        // Use the closest data point for this hour
        const closestPoint = dataPoints[0];
        if (closestPoint) {
          // Add some realistic variation for temperature throughout the day
          let hourTemp = closestPoint.temp;
          if (hour >= 0 && hour <= 6) hourTemp -= 2; // Colder at night
          if (hour >= 12 && hour <= 16) hourTemp += 2; // Warmer in afternoon
          
          hourlyData.push({
            time: hourTime,
            temp: hourTemp,
            humidity: closestPoint.humidity,
            wind: closestPoint.wind.toFixed(1),
            icon: closestPoint.icon,
            weather: closestPoint.weather
          });
        }
      }
      
      return hourlyData;
    }

    // Hide weather detail modal
    function hideWeatherDetail() {
      document.getElementById('weather-detail-modal').classList.add('hidden');
      checkRobotVisibility();
    }

    // Refresh weather forecast
    async function refreshWeatherForecast() {
      if (!weatherData) return;
      
      try {
        if (navigator.geolocation) {
          const position = await new Promise((resolve, reject) => {
            navigator.geolocation.getCurrentPosition(resolve, reject);
          });
          const { latitude, longitude } = position.coords;
          await fetchWeatherByCoords(latitude, longitude);
        } else {
          throw new Error('Geolocation not supported');
        }
      } catch (error) {
        await fetchWeatherByCity(weatherLocation);
      }
    }

    // Use my location for weather
    function useMyLocationForWeather() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          async (position) => {
            const { latitude, longitude } = position.coords;
            await fetchWeatherByCoords(latitude, longitude);
          },
          (error) => {
            showToast('Unable to get your location');
          }
        );
      } else {
        showToast('Geolocation not supported by your browser');
      }
    }

    // Toggle weather units
    function toggleWeatherUnits() {
      weatherUseMetric = !weatherUseMetric;
      const unitElement = document.getElementById('weather-unit');
      unitElement.textContent = weatherUseMetric ? '¬∞C' : '¬∞F';
      
      // Refresh data with new units
      if (weatherData) {
        if (weatherData.current.name) {
          fetchWeatherByCity(`${weatherData.current.name}, ${weatherData.current.sys.country}`);
        }
      }
    }

    // Initialize app on load
    document.addEventListener('DOMContentLoaded', function() {
      // Start the preloader animation
      hidePreloader();
      
      // Load the app data
      loadData();
      
      // Initialize robot visibility
      checkRobotVisibility();
      
      // Initialize AI assistant
      setTimeout(() => {
        showRobotThought("Hello! I'm your AI assistant. Click me for help!");
      }, 2000);
    });

    // AI Assistant functions
    // Knowledge base for the AI
    const aiKnowledgeBase = {
      "add items to cart": {
        answer: "To add items to your cart:\n1. Type the item name in the 'Item Name' field\n2. Enter the price in Rand (R)\n3. Set the quantity using + or - buttons\n4. Click '+ Add to Cart'\n\nüí° Tip: Use voice input by clicking the microphone icon next to each field!",
        category: "shopping"
      },
      "check weather": {
        answer: "The weather forecast is displayed below your cart. You can:\n‚Ä¢ See 5-day forecast at a glance\n‚Ä¢ Click on any day for detailed hourly forecast\n‚Ä¢ Refresh with current location\n‚Ä¢ Toggle between ¬∞C and ¬∞F\n\nüå§Ô∏è Weather helps plan shopping trips!",
        category: "weather"
      },
      "calculate change": {
        answer: "To calculate change:\n1. Click 'Cart' button\n2. Click 'Proceed' in cart modal\n3. Enter amount of money you have\n4. Click 'Calculate Change'\n5. Click 'Save' to complete\n\nüí∞ The app shows if you need more money or change due!",
        category: "payment"
      },
      "save presets": {
        answer: "Save frequently bought items as presets:\n1. Fill item name and price\n2. Click the bookmark icon (‚òÖ) in Add Item form\nOR\n3. Use 'Quick Add' button\n4. Create new presets in the modal\n5. Click any preset to add to cart instantly!",
        category: "presets"
      },
      "import list": {
        answer: "Import shopping lists from text:\n1. Click 'Import List' button\n2. Paste your list (format: Milk 25.50 or Bread R15)\n3. Click 'Import Items'\n\nüìã Supports multiple formats with prices!",
        category: "import"
      },
      "view history": {
        answer: "View past orders:\n1. Click 'History' button\n2. See all completed orders with details\n3. Click 'Print' for receipts\n4. Click 'Delete' to remove old orders\n\nüìä All history is saved locally on your device!",
        category: "history"
      },
      "weather forecast": {
        answer: "Our weather features:\n‚Ä¢ 5-day detailed forecast\n‚Ä¢ Hourly temperature predictions\n‚Ä¢ Humidity and wind information\n‚Ä¢ Shopping tips based on weather\n‚Ä¢ Location-based updates\n\nüå°Ô∏è Perfect for planning shopping trips!",
        category: "weather"
      },
      "payment help": {
        answer: "Payment features:\n‚Ä¢ Calculate exact change needed\n‚Ä¢ Track amount paid vs total\n‚Ä¢ Save completed transactions\n‚Ä¢ Print receipts\n‚Ä¢ Voice input for amounts\n\nüí≥ Never miscalculate change again!",
        category: "payment"
      },
      "voice input": {
        answer: "Use voice commands for:\n‚Ä¢ Item names (click mic in item field)\n‚Ä¢ Prices (click mic in price field)\n‚Ä¢ AI questions (click Voice in chat)\n\nüé§ Works best in Chrome with clear speech!",
        category: "voice"
      },
      "about app": {
        answer: "BigTree Shopping Cart Features:\n‚Ä¢ Smart shopping list management\n‚Ä¢ Real-time weather integration\n‚Ä¢ Voice input capabilities\n‚Ä¢ Payment calculator\n‚Ä¢ Order history tracking\n‚Ä¢ Preset quick-add system\n\nüè™ Your all-in-one shopping companion!",
        category: "about"
      },
      "contact support": {
        answer: "For direct support:\n‚Ä¢ Developer: St Crijoh Studios\n‚Ä¢ Use the AI assistant for instant help\n‚Ä¢ Check 'About Us' page for more info\n\nüìß For urgent issues, try the tutorial section for guides!",
        category: "support"
      },
      "tutorial": {
        answer: "Learn how to use the app:\n1. Check the 'Tutorials' page from menu\n2. Watch interactive guides\n3. Practice with sample items\n4. Use the AI assistant for help\n\nüéì Start with adding a few test items!",
        category: "tutorial"
      }
    };

    // Default responses for unknown questions
    const defaultResponses = [
      "I'm here to help with shopping cart questions, weather info, and app guidance. Could you try rephrasing your question?",
      "That's an interesting question! I'm specially trained to help with shopping cart functions, weather forecasts, and payment calculations.",
      "Hmm, I'm not sure about that one. Try asking about adding items, checking weather, or calculating payments!",
      "I'm your shopping assistant! Ask me about how to use the cart, check weather forecasts, or manage your shopping lists.",
      "Let me help you with shopping-related questions! Try asking about adding items, checking prices, or weather forecasts."
    ];

    // Toggle robot assistant
    function toggleRobotAssistant() {
      const robotModal = document.getElementById('robot-modal');
      const robotStatus = document.getElementById('robot-status');
      const modalStatus = document.getElementById('robot-modal-status');
      
      if (!robotModal.classList.contains('hidden')) {
        hideRobotAssistant();
        return;
      }
      
      robotModal.classList.remove('hidden');
      isRobotActive = true;
      
      // Change status to active
      robotStatus.classList.remove('bg-red-500', 'bg-green-500');
      robotStatus.classList.add('bg-green-500');
      modalStatus.classList.remove('bg-red-500', 'bg-green-500');
      modalStatus.classList.add('bg-green-500');
      
      // Hide the floating robot
      hideRobot();
    }

    function hideRobotAssistant() {
      const robotModal = document.getElementById('robot-modal');
      robotModal.classList.add('hidden');
      isRobotActive = false;
      
      // Show the floating robot again
      setTimeout(() => {
        checkRobotVisibility();
      }, 300);
    }

    // Send question function
    function sendQuestion() {
      const input = document.getElementById('user-question');
      const question = input.value.trim();
      
      if (!question) return;
      
      // Add user message to chat
      addUserMessage(question);
      input.value = '';
      
      // Process question and get response
      processQuestion(question);
    }

    // Handle enter key press
    function handleQuestionKeyPress(event) {
      if (event.key === 'Enter') {
        sendQuestion();
      }
    }

    // Add user message to chat
    function addUserMessage(message) {
      const chatMessages = document.getElementById('chat-messages');
      
      const messageDiv = document.createElement('div');
      messageDiv.className = 'chat-message user bg-green-900/20 rounded-xl p-4 border border-green-500/20';
      messageDiv.innerHTML = `
        <div class="flex items-start space-x-2 justify-end">
          <div class="flex-1 text-right">
            <p class="text-white text-sm">${escapeHtml(message)}</p>
          </div>
          <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center">
            <i class="fas fa-user text-sm"></i>
          </div>
        </div>
      `;
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // Add to history
      chatHistory.push({ type: 'user', message: message });
    }

    // Add bot message to chat
    function addBotMessage(message) {
      const chatMessages = document.getElementById('chat-messages');
      const typingIndicator = document.getElementById('typing-indicator');
      
      // Hide typing indicator
      typingIndicator.classList.add('hidden');
      
      const messageDiv = document.createElement('div');
      messageDiv.className = 'chat-message bot bg-blue-900/30 rounded-xl p-4 border border-blue-500/20';
      messageDiv.innerHTML = `
        <div class="flex items-start space-x-2">
          <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center">
            <i class="fas fa-robot text-sm"></i>
          </div>
          <div class="flex-1">
            ${formatBotResponse(message)}
          </div>
        </div>
      `;
      
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      
      // Add to history
      chatHistory.push({ type: 'bot', message: message });
      
      // Speak the response
      speakResponse(message);
    }

    // Format bot response with icons and formatting
    function formatBotResponse(text) {
      // Replace newlines with <br> and add icons
      let formatted = escapeHtml(text);
      
      // Add icons for common patterns
      formatted = formatted
        .replace(/\n/g, '<br>')
        .replace(/üí°/g, '<i class="fas fa-lightbulb text-yellow-300"></i>')
        .replace(/üí∞/g, '<i class="fas fa-coins text-yellow-300"></i>')
        .replace(/üå§Ô∏è/g, '<i class="fas fa-cloud-sun text-blue-300"></i>')
        .replace(/üìã/g, '<i class="fas fa-clipboard text-blue-300"></i>')
        .replace(/üé§/g, '<i class="fas fa-microphone text-purple-300"></i>')
        .replace(/üè™/g, '<i class="fas fa-store text-green-300"></i>')
        .replace(/üìä/g, '<i class="fas fa-chart-bar text-blue-300"></i>')
        .replace(/üí≥/g, '<i class="fas fa-credit-card text-green-300"></i>')
        .replace(/üìß/g, '<i class="fas fa-envelope text-blue-300"></i>')
        .replace(/üéì/g, '<i class="fas fa-graduation-cap text-purple-300"></i>')
        .replace(/üå°Ô∏è/g, '<i class="fas fa-thermometer-half text-red-300"></i>');
      
      // Format numbered lists
      formatted = formatted.replace(/(\d+\.)/g, '<strong>$1</strong>');
      
      return `<p class="text-white text-sm">${formatted}</p>`;
    }

    // Process user question
    function processQuestion(question) {
      const typingIndicator = document.getElementById('typing-indicator');
      const lowerQuestion = question.toLowerCase();
      
      // Show typing indicator
      typingIndicator.classList.remove('hidden');
      
      // Simulate thinking delay
      setTimeout(() => {
        let found = false;
        
        // Check knowledge base
        for (const key in aiKnowledgeBase) {
          if (lowerQuestion.includes(key)) {
            addBotMessage(aiKnowledgeBase[key].answer);
            found = true;
            break;
          }
        }
        
        // If not found, use default response
        if (!found) {
          const randomResponse = defaultResponses[Math.floor(Math.random() * defaultResponses.length)];
          addBotMessage(randomResponse);
        }
      }, 1000 + Math.random() * 1000); // Random delay between 1-2 seconds
    }

    // Quick question function
    function askQuestion(question) {
      const input = document.getElementById('user-question');
      input.value = question;
      sendQuestion();
    }

    // Toggle speech recognition
    function toggleSpeechRecognition() {
      const voiceBtn = document.getElementById('voice-btn');
      
      if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
        addBotMessage("Voice recognition is not supported in your browser. Try Chrome or Edge.");
        return;
      }
      
      if (!speechRecognitionActive) {
        startSpeechRecognition();
        voiceBtn.innerHTML = '<i class="fas fa-microphone-slash"></i> Stop';
        voiceBtn.classList.add('text-red-300');
      } else {
        stopSpeechRecognition();
        voiceBtn.innerHTML = '<i class="fas fa-microphone"></i> Voice';
        voiceBtn.classList.remove('text-red-300');
      }
    }

    function startSpeechRecognition() {
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
      speechRecognition = new SpeechRecognition();
      speechRecognition.lang = 'en-US';
      speechRecognition.continuous = false;
      speechRecognition.interimResults = false;
      
      speechRecognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        document.getElementById('user-question').value = transcript;
        addUserMessage(transcript);
        processQuestion(transcript);
      };
      
      speechRecognition.onerror = (error) => {
        if (error.error === 'not-allowed' || error.error === 'permission-denied') {
          addBotMessage("Microphone permission denied. Please allow microphone access.");
        }
        stopSpeechRecognition();
      };
      
      speechRecognition.onend = () => {
        stopSpeechRecognition();
      };
      
      try {
        speechRecognition.start();
        speechRecognitionActive = true;
      } catch (e) {
        addBotMessage("Voice recognition failed to start. Try again.");
      }
    }

    function stopSpeechRecognition() {
      if (speechRecognition) {
        speechRecognition.stop();
      }
      speechRecognitionActive = false;
      const voiceBtn = document.getElementById('voice-btn');
      voiceBtn.innerHTML = '<i class="fas fa-microphone"></i> Voice';
      voiceBtn.classList.remove('text-red-300');
    }

    // Text-to-speech function
    function speakResponse(text) {
      if (!('speechSynthesis' in window)) return;
      
      // Stop any ongoing speech
      speechSynthesis.cancel();
      
      // Clean text for speech (remove icons/emojis)
      const cleanText = text.replace(/[^\w\s.,!?\-]/g, ' ').replace(/\s+/g, ' ').trim();
      
      const utterance = new SpeechSynthesisUtterance(cleanText);
      utterance.lang = 'en-US';
      utterance.rate = 1.0;
      utterance.pitch = 1.0;
      utterance.volume = 1.0;
      
      // Optional: Change voice to a more robotic one if available
      const voices = speechSynthesis.getVoices();
      const robotVoice = voices.find(voice => voice.name.includes('Google') || voice.name.includes('Robotic'));
      if (robotVoice) {
        utterance.voice = robotVoice;
      }
      
      utterance.onstart = () => {
        const robotStatus = document.getElementById('robot-status');
        const modalStatus = document.getElementById('robot-modal-status');
        robotStatus.classList.remove('bg-green-500');
        robotStatus.classList.add('bg-blue-500');
        modalStatus.classList.remove('bg-green-500');
        modalStatus.classList.add('bg-blue-500');
      };
      
      utterance.onend = () => {
        const robotStatus = document.getElementById('robot-status');
        const modalStatus = document.getElementById('robot-modal-status');
        robotStatus.classList.remove('bg-blue-500');
        robotStatus.classList.add('bg-green-500');
        modalStatus.classList.remove('bg-blue-500');
        modalStatus.classList.add('bg-green-500');
      };
      
      speechSynthesis.speak(utterance);
    }

    // Show robot thought bubble
    function showRobotThought(message) {
      const thought = document.getElementById('robot-thought');
      thought.querySelector('span').textContent = message;
      thought.classList.remove('hidden');
      
      setTimeout(() => {
        thought.classList.add('hidden');
      }, 3000);
    }

    // Clear chat history
    function clearChat() {
      const chatMessages = document.getElementById('chat-messages');
      chatMessages.innerHTML = '';
      chatHistory = [];
      
      // Reset to initial bot message
      const initialMessage = document.createElement('div');
      initialMessage.className = 'chat-message bot bg-blue-900/30 rounded-xl p-4 border border-blue-500/20';
      initialMessage.innerHTML = `
        <div class="flex items-start space-x-2">
          <div class="w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center">
            <i class="fas fa-robot text-sm"></i>
          </div>
          <div class="flex-1">
            <p class="text-white text-sm mb-2">
              Hello! I'm your BigTree AI Assistant! ü§ñ I can help you with:
            </p>
            <div class="space-y-2">
              <div class="flex items-center text-green-300">
                <i class="fas fa-check-circle mr-2"></i>
                <span class="text-sm">Shopping cart questions</span>
              </div>
              <div class="flex items-center text-green-300">
                <i class="fas fa-check-circle mr-2"></i>
                <span class="text-sm">Weather forecast explanations</span>
              </div>
              <div class="flex items-center text-green-300">
                <i class="fas fa-check-circle mr-2"></i>
                <span class="text-sm">App usage guidance</span>
              </div>
              <div class="flex items-center text-green-300">
                <i class="fas fa-check-circle mr-2"></i>
                <span class="text-sm">Payment calculations</span>
              </div>
              <p class="text-blue-300 text-xs mt-3">
                <i class="fas fa-lightbulb mr-1"></i>
                What would you like help with today?
              </p>
            </div>
          </div>
        </div>
      `;
      
      chatMessages.appendChild(initialMessage);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }

  </script>

 </body>
</html>
